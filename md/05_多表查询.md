### å¤šè¡¨æŸ¥è¯¢

æŸ¥è¯¢å¤šä¸ªè¡¨ä¸­çš„å­—æ®µä¿¡æ¯ï¼Œåœ¨`FROM`åå†™ä¸Šè¦æŸ¥è¯¢çš„å¤šä¸ªè¡¨ï¼Œè¡¨ä¸è¡¨é—´ä»¥é€—å·åˆ†éš”
åœ¨`WHERE`è¯­å¥ä¸­å†™å…¥è¡¨çš„è¿æ¥æ¡ä»¶ï¼Œå¦‚æœè¦è¿æ¥nä¸ªè¡¨ï¼Œéœ€è¦æœ‰n-1æ¡è¿æ¥æ¡ä»¶

#### 1. ç¬›å¡å°”ç§¯

å¦‚æœåœ¨å¤šè¡¨æŸ¥è¯¢æ—¶æ²¡æœ‰å†™è¿æ¥æ¡ä»¶ï¼Œåˆ™å¾—åˆ°çš„æŸ¥è¯¢æ•°æ®è¡Œæ•°ä¸ºæ¯å¼ è¡¨çš„è¡Œæ•°ç›¸ä¹˜ï¼Œå³æ¯å¼ è¡¨çš„æ¯ä¸€è¡Œéƒ½ä¸å…¶ä»–è¡¨çš„æ¯ä¸€è¡Œè¿æ¥
è¿™å°±æ—¶ç¬›å¡å°”ç§¯

å‘˜å·¥è¡¨ï¼Œéƒ¨é—¨è¡¨ï¼Œä½ç½®è¡¨ç»“æ„å¦‚ä¸‹

![avatar](../source/img/å‘˜å·¥.png)

![avatar](../source/img/éƒ¨é—¨.png)

![avatar](../source/img/ä½ç½®.png)

å¦‚æœæˆ‘ä»¬è¦æŸ¥è¯¢å‘˜å·¥idä»¥åŠéƒ¨é—¨åç§°

```sql
SELECT employee_id,department_name
FROM employees,departments
# è¿æ¥æ¡ä»¶(å½“ä¸¤å¼ è¡¨ä¸­department_idå­—æ®µçš„å€¼ç›¸åŒæ—¶æ‰è¿æ¥)
WHERE employees.department_id = departments.department_id;
```

å¦‚æœå†æ·»åŠ ä¸€ä¸ªæŸ¥è¯¢å­—æ®µdepartment_idå‘¢
è¿™æ ·å†™ï¼Ÿ

```sql
SELECT employee_id,department_name,department_id
FROM employees,departments
# è¿æ¥æ¡ä»¶(å½“ä¸¤å¼ è¡¨ä¸­department_idå­—æ®µçš„å€¼ç›¸åŒæ—¶æ‰è¿æ¥)
WHERE employees.department_id = departments.department_id;
```

ä¸Šé¢çš„ä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ­¤æ—¶è¿æ¥çš„ä¸¤å¼ è¡¨ä¸­éƒ½æœ‰è¿™ä¸ªå­—æ®µï¼Œä¸æ¸…æ¥šåº”è¯¥ç”¨å“ªå¼ è¡¨çš„,æ‰€ä»¥æˆ‘ä»¬éœ€è¦åŠ ä¸Šè¡¨å

```sql
SELECT employee_id,department_name,employees.department_id
FROM employees,departments
# è¿æ¥æ¡ä»¶(å½“ä¸¤å¼ è¡¨ä¸­department_idå­—æ®µçš„å€¼ç›¸åŒæ—¶æ‰è¿æ¥)
WHERE employees.department_id = departments.department_id;
```

>*æ³¨æ„:å½“æˆ‘ä»¬æŸ¥è¯¢è¿æ¥çš„è¡¨ä¸­çš„å…±åŒå­—æ®µæ—¶ï¼Œå¿…é¡»æŒ‡å®šå…¶æ‰€å±è¡¨å*

å½“ç„¶ä»ä¼˜åŒ–è§’åº¦çœ‹ï¼Œåªè¦æ˜¯å¤šè¡¨è”æŸ¥ï¼Œæˆ‘ä»¬æ¯ä¸ªå­—æ®µéƒ½åº”è¯¥æ·»åŠ å…¶è¡¨å
æ‰€ä»¥ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬æœ€å¥½è¿™ä¹ˆå†™

```sql
SELECT employees.employee_id,departments.department_name,employees.department_id
FROM employees,departments
WHERE employees.department_id = departments.department_id;
```

#### 2. è¡¨çš„åˆ«å

æˆ‘ä»¬å¯ä»¥åœ¨å¤šè¡¨è”æŸ¥æ—¶åœ¨ç»™è¡¨èµ·åˆ«åï¼Œä¸å­—æ®µåˆ«åç±»ä¼¼

```sql
SELECT e.employee_id,d.department_name,e.department_id
# ç»™employeesèµ·åˆ«åä¸ºe,ç»™departmentsèµ·åˆ«åä¸ºd
FROM employees e,departments d
WHERE e.department_id = d.department_id;
```

>*æ³¨æ„:å¦‚æœç»™è¡¨èµ·äº†åˆ«åï¼Œé‚£ä¹ˆåœ¨`WHERE`ä¸­æˆ–`SELECT`ä¸­ä½¿ç”¨è¡¨åæ—¶å¿…é¡»è¦ç”¨åˆ«å*

ä¸‹é¢ä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨`SELECT`ä¸­ä½¿ç”¨äº†è¡¨åŸå

```sql
SELECT employees.employee_id,d.department_name,e.department_id
# ç»™employeesèµ·åˆ«åä¸ºe,ç»™departmentsèµ·åˆ«åä¸ºd
FROM employees e,departments d
WHERE e.department_id = d.department_id;
```

æŸ¥è¯¢å‘˜å·¥idï¼Œå§“åï¼Œéƒ¨é—¨åç§°ï¼Œä»¥åŠéƒ¨é—¨æ‰€åœ¨åŸå¸‚è¿™äº›å­—æ®µ

```sql
SELECT e.employee_id,e.last_name,d.department_name,l.city
FROM employees e,departments d,locations l 
WHERE e.department_id = d.department_id
AND d.location_id = l.location_id;
```

#### éç­‰å€¼è¿æ¥

è¿æ¥æ¡ä»¶ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œä¾‹å¦‚
æŸ¥è¯¢å‘˜å·¥çš„å§“åï¼Œå·¥èµ„åŠå…¶å·¥èµ„ç­‰çº§

```sql
SELECT last_name,salary,grade_level
FROM employees,job_grades
WHERE salary BETWEEN lowest_sal AND highest_sal; # éç­‰å€¼
```

#### è‡ªè¿æ¥

æœ‰æ—¶å€™ï¼Œè¡¨ä¸­çš„æŸä¸ªå­—æ®µä¼šå¼•ç”¨è‡ªå·±æœ¬èº«æŸæ¡è®°å½•çš„å­—æ®µ
æˆ‘ä»¬æŸ¥è¯¢æ—¶å¯ä»¥æŒ‰ç…§å¼•ç”¨çš„å­—æ®µ,å°†è¡¨ä¸å…¶è‡ªèº«è¿æ¥èµ·æ¥
ä¾‹å¦‚ï¼ŒæŸ¥è¯¢å‘˜å·¥idï¼Œå‘˜å·¥å§“åï¼ŒåŠå…¶ç®¡ç†è€…çš„idå’Œå§“å

```sql
SELECT e.employee_id,e.last_name,m.employee_id,m.last_name
FROM employees e,employees m 
WHERE e.manager_id = m.employee_id; # employeesè¡¨ä¸­ï¼Œmanager_idå¼•ç”¨ç€è‡ªèº«çš„employee_idå­—æ®µ
```

#### å†…è¿æ¥ä¸å¤–è¿æ¥

ä¸Šè¿°æˆ‘ä»¬è¿›è¡Œå¤šè¡¨æŸ¥è¯¢æ—¶éƒ½æ˜¯å°†è¿æ¥çš„è¡¨ä¸­æœ‰å¯¹åº”å­—æ®µçš„è¡Œæ‰è¿æ¥ï¼Œè¢«ç§°ä½œå†…è¿æ¥
è€Œå°†ä¸å¯¹åº”çš„è¡Œä¹ŸæŸ¥å‡ºæ¥ç§°ä½œå¤–è¿æ¥
å¤–è¿æ¥åˆ†ä¸º

1. å·¦å¤–è¿æ¥ï¼Œå³å°†å·¦è¡¨ä¸­æ²¡æœ‰æ»¡è¶³è¿æ¥æ¡ä»¶çš„è¡Œä¹ŸæŸ¥è¯¢å‡ºæ¥
2. å³å¤–è¿æ¥ï¼Œå³å°†å³è¡¨ä¸­æ²¡æœ‰æ»¡è¶³è¿æ¥æ¡ä»¶çš„è¡Œä¹ŸæŸ¥è¯¢å‡ºæ¥
3. å…¨ï¼ˆæ»¡ï¼‰å¤–è¿æ¥ï¼Œå°†å·¦å³è¡¨ä¸­æ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„è¡Œéƒ½æŸ¥è¯¢å‡ºæ¥

#### sql2å†…å¤–è¿æ¥

sql2å³sql92ï¼Œå®ƒçš„å†™æ³•æ›´ç®€å•
å†…è¿æ¥å°±æ˜¯å‰é¢æ‰€å†™çš„ï¼Œä½¿ç”¨`FROM`ä¸`WHERE`å³å¯
å¤–è¿æ¥ä½¿ç”¨`+`æ¥è¿æ¥
å¦‚æœæˆ‘ä»¬è¦æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„ç”¨æˆ·idå³å…¶å¯¹åº”çš„éƒ¨é—¨åç§°ï¼Œç”¨sql92å¯ä»¥è¿™ä¹ˆå†™

```sql
SELECT employee_id,department_name
FROM employees,departments
WHERE employees.department_id = departments.department_id(+);
```

å¦‚ä¸Šï¼Œå³ä¸ºå·¦å¤–è¿æ¥ï¼Œå¯ä»¥è¿™ä¹ˆç†è§£ï¼Œå› ä¸ºæˆ‘ä»¬è¦æŸ¥è¯¢å‡ºemployeesè¡¨ä¸­æ‰€æœ‰æ•°æ®ï¼Œè€Œdepartmentsè¡¨ä¸­æˆ‘ä»¬åªéœ€è¦
æ»¡è¶³è¿æ¥æ¡ä»¶çš„æ•°æ®ï¼ŒæŸ¥è¯¢å‡ºçš„ç»“æœè‚¯å®šæ˜¯å·¦>å³ï¼Œä¸ºäº†è®©ä¸¤å¼ è¡¨é«˜åº¦ç›¸ç­‰ï¼Œå¾€å³è¡¨ä¸­æ·»åŠ ä¸€ä¸ª`+`

> *æ³¨æ„ï¼Œä»¥ä¸Šå†™æ³•åœ¨mysqlä¸­ä¼šæŠ¥é”™ï¼Œå› ä¸ºmysqlå¹¶ä¸æ”¯æŒ`+`æ¥å®ç°å¤–è¿æ¥*

#### sql3å†…å¤–è¿æ¥

sql3å³sql99ï¼Œå†™æ³•è¾ƒsql2æ›´å¤æ‚ï¼Œä½†å¯è¯»æ€§æ›´é«˜

##### å†…è¿æ¥

sql99ä½¿ç”¨`è¡¨å JOIN è¡¨å ON è¿æ¥æ¡ä»¶`æ¥è¿æ¥ä¸¤å¼ è¡¨ï¼Œå¦‚æœè¦è¿æ¥å¤šå¼ è¡¨ï¼Œåªç”¨åœ¨åé¢ç»§ç»­æ·»åŠ `JOIN...ON...`å³å¯
ä¾ç„¶ä½¿ç”¨å‰é¢çš„ä¾‹å­
æŸ¥è¯¢å‘˜å·¥idï¼Œå§“åï¼Œéƒ¨é—¨åç§°ï¼Œä»¥åŠéƒ¨é—¨æ‰€åœ¨åŸå¸‚è¿™äº›å­—æ®µ

```sql
SELECT e.employee_id,e.last_name,d.department_name,l.city
FROM employees e JOIN departments d
ON e.department_id = d.department_id
JOIN locations l  # ç»§ç»­è¿æ¥è¡¨
ON d.location_id = l.location_id; 
```

å…¶å®ä¸Šé¢çš„ä»£ç æˆ‘ä»¬çœç•¥äº†ä¸€ä¸ªå…³é”®å­—ï¼Œå³å†…è¿æ¥å…³é”®`INNER`,å®ƒé€šå¸¸å¯ä»¥è¢«çœç•¥ï¼Œå¦‚æœè¦åŠ ä¸Šå®ƒï¼Œä»£ç æ˜¯è¿™æ ·çš„

```sql
SELECT e.employee_id,e.last_name,d.department_name,l.city
FROM employees e INNER JOIN departments d
ON e.department_id = d.department_id
INNER JOIN locations l  # ç»§ç»­è¿æ¥è¡¨
ON d.location_id = l.location_id;
```

`INNER`ä»£è¡¨å†…è¿æ¥çš„è¯ï¼Œè‡ªç„¶è€Œç„¶çš„ï¼Œæˆ‘ä»¬å°±æƒ³åˆ°äº†ä¸¤ä¸€ä¸ªå•è¯`OUTER`,ä¸é”™å®ƒå°±æ˜¯å¤–è¿æ¥å…³é”®å­—ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸Šé¢çš„ä¾‹å­
æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„ç”¨æˆ·idå³å…¶å¯¹åº”çš„éƒ¨é—¨åç§°

> *æ³¨æ„ï¼šæœ‰æ‰€æœ‰è¿™ä¸¤ä¸ªå­—æ—¶ï¼Œå¤§æ¦‚ç‡è¦æ±‚å¤–è¿æ¥*

```sql
SELECT employee_id,department_name
FROM employees LEFT JOIN departments
ON employees.department_id = departments.department_id;
```

ğŸ¤”ï¼Œä¸Šé¢çš„ä»£ç æ€ä¹ˆæ²¡æœ‰`OUTER`,æ²¡é”™ï¼Œå’Œå®ƒå…„å¼Ÿ`INNER`ä¸€æ ·ï¼Œå®ƒä¹Ÿå¯ä»¥è¢«çœç•¥ï¼Œå¦‚æœä¸çœç•¥å®ƒï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™

```sql
SELECT employee_id,department_name
FROM employees LEFT OUTER JOIN departments
ON employees.department_id = departments.department_id;
```

å·¦å¤–è¿æ¥ -> `LEFT OUTER`ï¼Œå³å¤–è¿æ¥ -> `RIGHT OUTER`
é‚£ä¹ˆå…¨å¤–è¿æ¥å‘¢?
åœ¨sql3ä¸­åº”è¯¥æ˜¯`FULL OUTER`,ä½†å¾ˆå¯æƒœçš„æ˜¯ï¼Œmysqlä¾ç„¶ä¸æ”¯æŒğŸ‘»ğŸ‘»ï¼Œæˆ‘ä»¬éœ€è¦å…¶ä»–è¯­å¥çš„å¸®åŠ©æ¥è®©æˆ‘ä»¬å®Œæˆæ»¡å¤–è¿æ¥

#### UNION

`UNION`å…³é”®å­—ï¼Œå¯ä»¥å°†ä¸¤ä¸ª`SELECT`çš„ç»“æœé›†åˆå¹¶ä¸ºä¸€ä¸ªï¼Œé‡å¤åŒºåŸŸåªä¿ç•™ä¸€æ¬¡
`UNION ALL`ä¸¤å¼ è¡¨ä¸­é‡å¤çš„åŒºåŸŸä¼šæœ‰å…¨éƒ¨ä¿ç•™

> *æ³¨æ„ï¼šä½¿ç”¨`UNION`æ—¶ï¼Œä¸¤ä¸ªç»“æœé›†åˆ—æ•°ï¼Œæ•°æ®ç»“æ„å¿…é¡»ç›¸ç­‰ï¼Œå¹¶ä¸”ç›¸äº’å¯¹åº”
> å¼€å‘ä¸­ä½¿ç”¨`UNION ALL`ï¼Œå ç”¨çš„èµ„æºè¾ƒå°ï¼Œå› ä¸ºä¸ç”¨å»é‡*

7ç§è¿æ¥æ“ä½œ

![avatar](../source/img/joins.png)

å®ç°(ä»¥employeeså’Œdeparmetsè¡¨ä¸ºä¾‹)

ä¸­å›¾ï¼Œå†…è¿æ¥

```sql
SELECT employee_id,department_name
FROM employees JOIN departments
ON employees.department_id = departments.department_id;
```

å·¦ä¸Šå›¾ï¼Œå·¦å¤–è¿æ¥

```sql 
SELECT employee_id,department_name
FROM employees LEFT JOIN departments
ON employees.department_id = departments.department_id;
```

å³ä¸Šå›¾ï¼Œå³å¤–è¿æ¥

```sql 
SELECT employee_id,department_name
FROM employees RIGHT JOIN departments
ON employees.department_id = departments.department_id;
```

å·¦ä¸­å›¾

```sql 
SELECT employee_id,department_name
FROM employees LEFT JOIN departments
ON employees.department_id = departments.department_id
WHERE departments.department_id is NULL;
```

å³ä¸­å›¾

```sql 
SELECT employee_id,department_name
FROM employees RIGHT JOIN departments
ON employees.department_id = departments.department_id
WHERE employees.department_id is NULL;
```

å·¦ä¸‹å›¾ï¼Œå…¨å¤–è¿æ¥

1. å·¦ä¸Š `UNION ALL` å³ä¸­
2. å³ä¸Š `UNION ALL` å·¦ä¸­

```sql
# å·¦ä¸Š
SELECT employee_id,department_name
FROM employees RIGHT JOIN departments
ON employees.department_id = departments.department_id
UNION ALL
# å³ä¸­
SELECT employee_id,department_name
FROM employees LEFT JOIN departments
ON employees.department_id = departments.department_id
WHERE employees.department_id is NULL;
```

å³ä¸‹
å·¦ä¸­ `UNION ALL` å³ä¸­

```sql
SELECT employee_id,department_name
FROM employees LEFT JOIN departments
ON employees.department_id = departments.department_id
WHERE departments.department_id is NULL
UNION ALL
SELECT employee_id,department_name
FROM employees RIGHT JOIN departments
ON employees.department_id = departments.department_id
WHERE employees.department_id is NULL;
```








